# 🎆 Python花火エフェクト実装チュートリアル
<div align="center">

[简体中文](README_CN.md) / [繁体中文](README_TC.md) / [English](README.md) / [Deutsch](README_DE.md) / 日本語

</div>
これはPygameを使用して実装された花火エフェクトプログラムで、リアルな花火アニメーション、祝福テキスト、星空の背景、月のエフェクトを含んでいます。このチュートリアルでは、この興味深いプロジェクトを段階的に実装する方法を説明します。

## プロジェクト概要

本プロジェクトは以下の機能を実装しています：
- 🎇 ランダムに生成される花火エフェクト
- ✨ グラデーションと消散効果を持つパーティクルシステム
- 💝 ランダムに表示される中国語の祝福テキスト
- 🌟 きらめき効果のある星空背景
- 🌕 リアルな月のエフェクト（光輪と月面の詳細を含む）
- 🖱️ マウスクリックによるインタラクション
- 🎁 月特殊効果花火です

## 技術原理

### 🔮 パーティクルシステムの原理
パーティクルシステムは花火エフェクトを実装するための核心技術で、以下の側面を含みます：
1. **パーティクルライフサイクル管理**：各パーティクルはライフサイクルカウンターを持ち、ライフサイクルが終了すると破棄されます。
2. **物理運動シミュレーション**：速度ベクトルと角度を使用してパーティクルの運動軌跡を制御します。
3. **カラーグラデーション**：パーティクルのアルファチャンネル値を調整してフェードイン・フェードアウト効果を実現します。
4. **サイズ変更**：パーティクルサイズが時間とともに徐々に小さくなり、リアリティを高めます。

### 💥 花火爆発エフェクト
花火爆発エフェクトは以下の原理に基づいています：
1. **初期速度分布**：極座標系を使用して360度範囲内でランダムに初期速度ベクトルを生成します。
2. **爆発形状制御**：円形、星形、球形の3種類の花火形状をサポートします。
3. **サウンド同期**：爆発時にランダムに選択されたサウンドエフェクトを再生し、視聴覚体験を向上させます。
4. **テキストパーティクルエフェクト**：パーティクルシステムを使用してテキスト表示をシミュレートし、グラデーション消散効果を実現します。

### 🌙 月のレンダリング実装
月のエフェクト実装には以下の特徴が含まれています：
1. **画像読み込み**：PNG形式の月画像を使用し、透明度を維持します。
2. **インタラクティブエッグ**：月の領域にマウスを重ねると特別な文字の花火が発生します。
2. **光輪効果**：多層グラデーションリングを使用して柔らかい光輪を作成します。
3. **インタラクティブエッグ**:特殊な文字の花火を触発する月の区域にマウスをかけます。

## 🛠️ 環境設定

### 1. Python環境要件
- Python 3.8+
- pipパッケージマネージャー

### 2. 依存関係のインストール
```bash
pip install pygame==2.5.0
```

### 3. リソースファイルの準備
1. **サウンドファイル**：
   - explosion.mp3：メイン爆発音
   - explosion2.mp3：セカンダリ爆発音
   - explosion3.mp3：フィナーレ音

2. **画像ファイル**：
   - moon.png：月画像
   - logo.ico：プログラムアイコン

## 📝 コアクラス設計

### 1. ゲーム設定（GameConfig）
```python
@dataclass
class GameConfig:
    SCREEN_WIDTH: int = info.current_w
    SCREEN_HEIGHT: int = info.current_h
    FPS: int = 60
    FIREWORK_SPAWN_RATE: float = 0.05
    TEXT_SPAWN_RATE: float = 0.2
```

### 2. パーティクルシステム（Particle）
```python
class Particle:
    def __init__(self, x: float, y: float, color: Tuple[int, int, int], 
                 angle: Optional[float] = None, is_text: bool = False):
        self.speed = random.uniform(0.3, 1.5) if is_text else random.uniform(2, 8)
        self.angle = angle if angle is not None else random.uniform(0, 2 * math.pi)
        self.lifetime = random.randint(100, 140) if is_text else random.randint(40, 80)
```

### 3. 花火クラス（Firework）
```python
class Firework:
    def __init__(self):
        self.pattern = random.choice(['circle', 'star', 'sphere'])
        self.show_text = True if ResourceManager._moon_clicked else random.random() < GameConfig.TEXT_SPAWN_RATE
        self.target_explosion_height = random.uniform(min_height, max_height)
```

## 🎮 インタラクション機能説明

1. **マウスクリック発射**
   - 画面上の任意の位置をクリックして花火を発射
   - 花火は底部から上昇し、クリックしたX座標位置で爆発

2. **月のイースターエッグ**
   - 月の領域にマウスを重ねると特別な花火が発生
   - 特別な花火は「イースターエッグ！」テキストを表示
   - 月の位置から発射され、ユニークな効果を演出

## ⚡ パフォーマンス最適化

### 1. パーティクルシステムの最適化
- テキストパーティクルは低いサンプリングレート（0.3）を使用してパーティクル数を削減
- テキストと通常パーティクルに異なるライフサイクル管理を使用
- パーティクルサイズと透明度のスムーズな遷移

### 2. レンダリング最適化
- SRCALPHA表面を使用して透明効果を処理
- 月の光輪領域での星のレンダリングを回避
- レイヤードレンダリングで視覚効果を保証

### 3. メモリ最適化
- 消失した花火とパーティクルのタイムリーなクリーンアップ
- dataclassを使用してメモリ使用量を削減
- リソースファイルの統一管理

## ❓ よくある質問と解決策

### 1. パフォーマンスの問題
Q: 実行時に遅延が発生する？
A: 以下の解決策を試してください：
- TEXT_SPAWN_RATE値を下げる
- FIREWORK_SPAWN_RATE値を減らす
- パーティクルのサンプリングレートを下げる

### 2. 表示の問題
Q: 花火エフェクトが不完全？
A: 以下の点を確認してください：
- 画面解像度設定が正しいことを確認
- ウィンドウサイズが適切か確認
- リソースファイルが完全か確認

## 📄 ライセンス

本プロジェクトはGNU General Public License v3.0（GNU GPL v3）の下でライセンスされています。これは以下を意味します：

- このコードを自由に使用、修正、配布できます
- 修正版を配布する場合、同じくGNU GPL v3ライセンスを使用する必要があります
- ソースコードを公開する必要があります
- 元の作者と修正内容を明示する必要があります
- 保証は提供されません